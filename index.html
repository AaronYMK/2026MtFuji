<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <title>富士山獵人旅遊手冊</title>
    
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffffff">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="富士山獵人">
    
    <script src="https://cdn.tailwindcss.com"></script>

    <style>
        /* iOS 滾動優化 */
        .scrollbar-hide::-webkit-scrollbar { display: none; }
        .scrollbar-hide { -ms-overflow-style: none; scrollbar-width: none; }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, "Helvetica Neue", Arial, sans-serif;
            -webkit-tap-highlight-color: transparent;
            /* 讓 iOS 滾動更滑順 */
            -webkit-overflow-scrolling: touch; 
        }

        /* iOS Safe Area 適配 (避開瀏海與底部橫條) */
        .safe-top { padding-top: env(safe-area-inset-top); }
        .safe-bottom { padding-bottom: env(safe-area-inset-bottom); }
        
        /* 動畫 */
        .fade-in { animation: fadeIn 0.3s ease-in-out; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(5px); } to { opacity: 1; transform: translateY(0); } }
    </style>
</head>
<body class="flex justify-center min-h-screen bg-neutral-100 sm:py-8 sm:items-center">

    <div id="app-container" class="w-full h-[100dvh] bg-white relative flex flex-col overflow-hidden sm:w-[375px] sm:h-[812px] sm:rounded-[40px] sm:shadow-2xl sm:border-[8px] border-slate-800">
        
        <div class="hidden sm:flex h-8 bg-white justify-between items-center px-6 pt-2 shrink-0 z-20">
           <span class="text-xs font-bold text-slate-800">09:00</span>
           <div class="flex gap-1">
             <div class="w-4 h-4 bg-slate-800 rounded-full opacity-20"></div>
             <div class="w-4 h-4 bg-slate-800 rounded-full opacity-20"></div>
             <div class="w-4 h-4 bg-slate-800 rounded-full"></div>
           </div>
        </div>

        <div id="header-section" class="relative p-6 pb-8 transition-colors duration-300 shrink-0 safe-top">
            </div>

        <div id="content-scroll" class="flex-1 overflow-y-auto px-6 pt-8 pb-32 scrollbar-hide">
            </div>

        <div id="nav-bar" class="absolute bottom-0 left-0 right-0 h-[88px] bg-white/95 backdrop-blur-md border-t border-gray-100 flex justify-around items-start pt-3 px-2 z-10 safe-bottom">
            </div>

        <div class="absolute bottom-28 right-6 pointer-events-none z-0">
           <div class="w-12 h-12 bg-white rounded-full shadow-xl flex items-center justify-center text-slate-800 border border-gray-100">
              <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 21 15 18 9 21 3 18 3 6"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="6" x2="15" y2="18"/></svg>
           </div>
        </div>

    </div>

    <script>
        // --- Service Worker Registration (PWA) ---
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(reg => console.log('SW registered!', reg))
                    .catch(err => console.log('SW failed', err));
            });
        }

        // --- Data ---
        const itineraryData = [
          {
            day: 1,
            date: "2026—01—26",
            title: "啟程：東京登陸作戰",
            themeColor: "from-green-100 to-green-50",
            headerBg: "bg-gradient-to-b from-green-100 to-green-50",
            accent: "text-green-600",
            events: [
              { time: "06:30", icon: "car", title: "機場接送出門", type: "transport" },
              { time: "09:30", icon: "plane", title: "航班 CI 100", desc: "TPE 桃園機場出發，展開獵人冒險。", type: "transport" },
              { time: "13:30", icon: "mapPin", title: "抵達成田 (NRT)", desc: "降落東京，準備切換鐵路模式。", type: "arrival" },
              { 
                time: "15:14", 
                icon: "train", 
                title: "成田特快 NEX", 
                desc: "搭乘舒適的紅色閃電直奔新宿。請鎖定成田32號或34號班次，享受沿途的日本鄉村風景。",
                location: "機場 B1 JR月台",
                type: "highlight"
              },
              { time: "17:00", icon: "hotel", title: "Yksi Stay", desc: "新宿的質感住宿，放下裝備，整備休息的秘密基地。", type: "stay" },
              { 
                time: "18:00", 
                icon: "utensils", 
                title: "牛かつもと村", 
                desc: "新宿必吃的炸牛排，外酥內嫩的口感，在石板上滋滋作響，是補充念能力的最佳補給品。", 
                type: "food" 
              },
              { time: "18:45", icon: "coffee", title: "Pearl Lady CHA BAR", type: "snack" },
              { 
                time: "19:00", 
                icon: "shopping", 
                title: "新宿逛街 & 扭蛋任務", 
                desc: "LUMINE EST → 愛迪達 → BicCamera → C-Pla → Gacha no Mori。鎖定目標，全神貫注！",
                mapDetails: ["LUMINE EST", "Adidas", "BicCamera", "Gacha no Mori"],
                type: "shopping"
              },
              { time: "22:30", icon: "utensils", title: "一蘭拉麵", desc: "深夜的靈魂慰藉，濃郁豚骨湯頭消除第一天的疲勞。", type: "food" }
            ]
          },
          {
            day: 2,
            date: "2026—01—27",
            title: "前進：富士山麓的修煉",
            themeColor: "from-blue-100 to-blue-50",
            headerBg: "bg-gradient-to-b from-blue-100 to-blue-50",
            accent: "text-blue-600",
            events: [
              { 
                time: "07:30", 
                icon: "train", 
                title: "富士回遊 3號", 
                desc: "直達河口湖的特急列車。請務必準時抵達新宿站中央本線9、10號月台，錯過就麻煩囉！",
                location: "JR新宿 9/10月台",
                type: "highlight"
              },
              { time: "09:45", icon: "car", title: "Budget 租車", desc: "取得移動載具，開始自駕探索模式。", type: "transport" },
              { 
                time: "10:45", 
                icon: "mapPin", 
                title: "忍野八海", 
                desc: "富士山雪水過濾後的八個清泉，水質清澈見底。彷彿使用了「凝」一般，能看見水底的每一處細節。",
                type: "spot"
              },
              { time: "12:00", icon: "utensils", title: "こし路", desc: "在地人推薦的牛肉燉飯，暖胃又暖心。", type: "food" },
              { 
                time: "13:45", 
                icon: "navigation", 
                title: "Kaba 水陸巴士", 
                desc: "衝進湖裡的瞬間超刺激！從湖面視角仰望巨大的富士山，是完全不同的震撼體驗。",
                type: "activity"
              },
              { 
                time: "14:30", 
                icon: "camera", 
                title: "平野之濱 & The Park", 
                desc: "絕美拍攝點與長池親水公園散策，配上 The Park 的鬆餅，享受悠閒的午後時光。",
                type: "spot"
              },
              { time: "16:30", icon: "hotel", title: "秀峰閣湖月", desc: "夢幻住宿，窗外就是逆富士。享受溫泉與懷石料理的頂級夜晚。", type: "stay" }
            ]
          },
          {
            day: 3,
            date: "2026—01—28",
            title: "探索：湖畔的二選一抉擇",
            themeColor: "from-purple-100 to-purple-50",
            headerBg: "bg-gradient-to-b from-purple-100 to-purple-50",
            accent: "text-purple-600",
            note: "本日依天氣狀況選擇方案",
            events: [
              { time: "10:30", icon: "star", title: "睡到自然醒", desc: "養精蓄銳，為了接下來的旅程。", type: "relax" },
              { time: "10:45", icon: "utensils", title: "手打うどん 彩花", desc: "Q彈帶勁的吉田烏龍麵，在地風味十足。", type: "food" },
              { 
                time: "11:45", 
                icon: "coffee", 
                title: "甜點獵人試驗", 
                desc: "抉擇吧！木村屋的絲滑布丁 vs Fujisan Shokupan 的富士山造型麵包。",
                type: "choice"
              },
              { 
                time: "12:15", 
                icon: "map", 
                title: "方案一 (晴)：纜車與神社", 
                desc: "搭乘河口湖纜車俯瞰全景，參拜可愛的兔神社。接著前往河口淺間神社與遙拜所，捕捉神聖視角。",
                subEvents: ["河口湖纜車", "うさぎ神社", "河口淺間神社", "天空鳥居(遙拝所)"],
                type: "scenario_a"
              },
              { 
                time: "12:30", 
                icon: "map", 
                title: "方案二 (雪)：音樂與藝術", 
                desc: "若遇雪天，轉往音樂盒之森美術館，在歐式庭園中聆聽自動演奏樂器的美妙樂章。",
                subEvents: ["音樂盒之森美術館", "河口淺間神社"],
                type: "scenario_b"
              },
              { time: "15:30", icon: "coffee", title: "HanaCafe Kikyou", desc: "桔梗信玄餅的官方咖啡廳，必吃濃郁的黑糖黃豆粉甜點。", type: "snack" },
              { time: "16:30", icon: "hotel", title: "秀峰閣湖月", desc: "再次回到溫暖的家，享受最後一晚的湖畔寧靜。", type: "stay" }
            ]
          },
          {
            day: 4,
            date: "2026—01—29",
            title: "回歸：吉田與新宿的穿梭",
            themeColor: "from-orange-100 to-orange-50",
            headerBg: "bg-gradient-to-b from-orange-100 to-orange-50",
            accent: "text-orange-600",
            events: [
              { time: "09:30", icon: "hotel", title: "Check-Out & 還車", desc: "告別秀峰閣，前往 Budget 還車，準備搭乘火車。", type: "transport" },
              { time: "10:15", icon: "shopping", title: "Fujiyama Cookie", desc: "車站旁的可愛伴手禮，將富士山的形狀帶回家。", type: "shopping" },
              { time: "12:00", icon: "camera", title: "新倉山公園 展望台", desc: "經典中的經典！五重塔與富士山的同框合影，需爬398階梯，展現獵人的體力吧！", type: "highlight" },
              { time: "13:15", icon: "mapPin", title: "小室淺間神社", desc: "寧靜莊嚴的神社，祈求旅途平安。", type: "spot" },
              { time: "13:45", icon: "coffee", title: "FabCafe Fuji", desc: "結合數位製造與咖啡的空間，稍作休息。", type: "snack" },
              { 
                time: "14:45", 
                icon: "camera", 
                title: "日川時計店 & 懷舊商店街", 
                desc: "本町通的知名攝影點，巨大的富士山聳立在復古街道盡頭，彷彿時光倒流。",
                type: "spot"
              },
              { time: "15:47", icon: "train", title: "富士回遊 94號", desc: "帶著滿滿回憶，搭乘特急列車返回繁華新宿。", type: "transport" },
              { time: "19:30", icon: "utensils", title: "焼肉うしふじ", desc: "回到東京的第一餐，用頂級燒肉慶祝這趟旅程。", type: "food" },
              { time: "21:00", icon: "shopping", title: "唐吉訶德大採購", desc: "最後衝刺！補齊所有藥妝與零食。", type: "shopping" }
            ]
          },
          {
            day: 5,
            date: "2026—01—30",
            title: "終章：滿載而歸",
            themeColor: "from-pink-100 to-pink-50",
            headerBg: "bg-gradient-to-b from-pink-100 to-pink-50",
            accent: "text-pink-600",
            events: [
              { time: "08:45", icon: "utensils", title: "らぁ麺や 嶋", desc: "極致美味的醬油拉麵，湯頭層次豐富，完美的早午餐選擇。", type: "food" },
              { time: "11:00", icon: "car", title: "行李寄放", desc: "新宿高速巴士總站 Busta Shinjuku，解放雙手輕鬆逛。", type: "transport" },
              { time: "12:30", icon: "shopping", title: "高島屋 & 手創館", desc: "最後的百貨巡禮，Al Dente 的義大利麵也不容錯過。", type: "shopping" },
              { time: "14:00", icon: "coffee", title: "Ochobohan Shinjuku", desc: "在離開前，享用最後一份精緻的抹茶甜點套餐。", type: "snack" },
              { 
                time: "15:08", 
                icon: "train", 
                title: "NEX 成田37號", 
                desc: "前往機場。JR新宿 5、6號月台。再見了，東京！",
                location: "JR新宿 5/6月台",
                type: "highlight"
              },
              { time: "23:30", icon: "car", title: "溫暖的家", desc: "平安抵達，旅程圓滿結束。", type: "arrival" }
            ]
          }
        ];

        // --- Icon Definitions (SVG Strings) ---
        const icons = {
            plane: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M2 22h20"/><path d="M13 2a2 2 0 0 0-2 2v10l-6-5-3 2 9 8 9-8-3-2-6 5V4a2 2 0 0 0-2-2z"/></svg>`,
            train: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="3" width="16" height="16" rx="2"/><path d="M4 11h16"/><path d="M12 3v8"/><path d="m8 19-2 3"/><path d="m18 22-2-3"/><circle cx="8" cy="15" r="1"/><circle cx="16" cy="15" r="1"/></svg>`,
            car: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"/><circle cx="7" cy="17" r="2"/><circle cx="17" cy="17" r="2"/><path d="M5 17h2"/><path d="M15 17h2"/></svg>`,
            utensils: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 2v7c0 1.1.9 2 2 2h4a2 2 0 0 0 2-2V2"/><path d="M7 2v20"/><path d="M21 15V2v0a5 5 0 0 0-5 5v6c0 1.1.9 2 2 2h3Zm0 0v7"/></svg>`,
            camera: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z"/><circle cx="12" cy="13" r="3"/></svg>`,
            mapPin: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z"/><circle cx="12" cy="10" r="3"/></svg>`,
            coffee: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 8h1a4 4 0 1 1 0 8h-1"/><path d="M3 8h14v9a4 4 0 0 1-4 4H7a4 4 0 0 1-4-4Z"/><line x1="6" y1="1" x2="6" y2="4"/><line x1="10" y1="1" x2="10" y2="4"/><line x1="14" y1="1" x2="14" y2="4"/></svg>`,
            hotel: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M10 22v-6.57"/><path d="M12 11h.01"/><path d="M12 7h.01"/><path d="M14 15.43V22"/><path d="M15 16a5 5 0 0 0-6 0"/><path d="M16 11h.01"/><path d="M16 7h.01"/><path d="M8 11h.01"/><path d="M8 7h.01"/><rect x="4" y="2" width="16" height="20" rx="2"/></svg>`,
            shopping: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2 3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4Z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-8 0"/></svg>`,
            star: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>`,
            map: `<svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 6 9 3 15 6 21 3 21 21 15 18 9 21 3 18 3 6"/><line x1="9" y1="3" x2="9" y2="21"/><line x1="15" y1="6" x2="15" y2="18"/></svg>`,
            navigation: `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="3 11 22 2 13 21 11 13 3 11"/></svg>`,
            chevronRight: `<svg xmlns="http://www.w3.org/2000/svg" width="12" height="12" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="m9 18 6-6-6-6"/></svg>`
        };

        // --- Render Functions ---

        let currentDayIndex = 0;

        function renderGonIcon() {
            return `
            <div class="w-12 h-12 rounded-full bg-green-500 border-2 border-white shadow-lg flex items-center justify-center overflow-hidden">
                <span class="text-white font-bold text-xs">GON</span>
            </div>`;
        }

        function renderKilluaIcon() {
            return `
            <div class="w-12 h-12 rounded-full bg-blue-500 border-2 border-white shadow-lg flex items-center justify-center overflow-hidden">
                 <span class="text-white font-bold text-xs">KILLUA</span>
            </div>`;
        }

        function renderEventCard(event, accentColor) {
            const isHighlight = event.type === 'highlight';
            const borderColor = isHighlight ? 'border-yellow-400' : 'border-gray-200';
            const dotColor = isHighlight ? 'bg-yellow-400' : 'bg-gray-300';
            const cardRing = isHighlight ? 'ring-2 ring-yellow-100' : '';
            const iconSvg = icons[event.icon] || icons.mapPin;

            let subEventsHtml = '';
            if (event.subEvents) {
                subEventsHtml = `<div class="mt-2 flex flex-wrap gap-1">
                      ${event.subEvents.map(sub => 
                        `<span class="text-xs bg-slate-50 text-slate-600 px-2 py-1 rounded-full border border-slate-100">${sub}</span>`
                      ).join('')}
                    </div>`;
            }

            let mapDetailsHtml = '';
            if (event.mapDetails) {
                 const spots = event.mapDetails.map((spot, idx) => {
                     const arrow = idx < event.mapDetails.length - 1 ? `<span class="text-slate-300 flex items-center">${icons.chevronRight}</span>` : '';
                     return `<span class="text-xs font-medium text-slate-600">${spot}</span>${arrow}`;
                 }).join('');
                 
                 mapDetailsHtml = `
                  <div class="mt-3 bg-slate-50 p-2 rounded-lg">
                      <div class="text-xs text-slate-400 mb-1 uppercase tracking-wide flex items-center">
                         <span class="mr-1">${icons.navigation}</span> 路線導引
                      </div>
                      <div class="flex flex-wrap gap-2 items-center">
                         ${spots}
                      </div>
                  </div>`;
            }

            let locationHtml = '';
            if (event.location) {
                locationHtml = `
                  <div class="flex items-center text-xs text-amber-600 mb-2 font-bold">
                    ${icons.mapPin}
                    <span class="ml-1">${event.location}</span>
                  </div>`;
            }

            let descHtml = '';
            if (event.desc) {
                descHtml = `
                  <p class="text-sm text-slate-500 leading-relaxed text-justify border-t border-gray-100 pt-2 mt-1">
                    ${event.desc}
                  </p>`;
            }

            return `
            <div class="relative mb-6 pl-8 border-l-2 ${borderColor} last:mb-0 fade-in">
              <div class="absolute -left-[9px] top-0 w-4 h-4 rounded-full border-2 border-white shadow-sm ${dotColor}"></div>
              
              <div class="bg-white rounded-xl shadow-sm p-4 ${cardRing}">
                <div class="flex justify-between items-start mb-2">
                  <div class="flex items-center gap-2">
                    <span class="text-sm font-bold bg-gray-100 px-2 py-0.5 rounded text-gray-600 font-mono">
                      ${event.time}
                    </span>
                    <div class="${accentColor}">
                      ${iconSvg}
                    </div>
                  </div>
                </div>
                
                <h3 class="text-lg font-bold text-slate-800 mb-1">${event.title}</h3>
                ${locationHtml}
                ${descHtml}
                ${subEventsHtml}
                ${mapDetailsHtml}
              </div>
            </div>`;
        }

        function renderApp() {
            const dayData = itineraryData[currentDayIndex];

            // 1. Update Header
            const headerEl = document.getElementById('header-section');
            headerEl.className = `relative p-6 pb-8 transition-colors duration-300 shrink-0 safe-top ${dayData.headerBg}`;
            headerEl.innerHTML = `
                <div class="flex justify-between items-center mb-4">
                    <span class="text-xs font-bold tracking-widest text-slate-500 uppercase bg-white/50 px-2 py-1 rounded backdrop-blur-sm">
                      Hunter Mission
                    </span>
                    <span class="text-xs font-bold text-slate-500 font-mono">
                      ${dayData.date}
                    </span>
                </div>

                <h1 class="text-3xl font-black text-slate-800 leading-tight mb-2">
                    Day ${dayData.day}
                </h1>
                <h2 class="text-xl font-bold ${dayData.accent} mb-4">
                    ${dayData.title}
                </h2>

                <div class="absolute -bottom-6 right-6 flex -space-x-3">
                      ${renderGonIcon()}
                      ${renderKilluaIcon()}
                </div>
            `;

            // 2. Update Content
            const contentEl = document.getElementById('content-scroll');
            let contentHtml = '';
            
            if (dayData.note) {
                contentHtml += `
                 <div class="mb-6 bg-yellow-50 border border-yellow-200 text-yellow-800 px-4 py-3 rounded-xl text-sm flex items-start gap-2">
                    <span class="mt-0.5 flex-shrink-0 text-yellow-600">${icons.star}</span>
                    ${dayData.note}
                 </div>`;
            }

            dayData.events.forEach(event => {
                contentHtml += renderEventCard(event, dayData.accent);
            });

            contentHtml += `
                <div class="text-center py-8 text-slate-300 text-xs tracking-widest uppercase">
                    Mission Ongoing
                </div>`;

            contentEl.innerHTML = contentHtml;
            contentEl.scrollTop = 0;

            // 3. Update Nav Bar
            const navEl = document.getElementById('nav-bar');
            navEl.innerHTML = itineraryData.map((d, idx) => {
                const isActive = currentDayIndex === idx;
                const activeClasses = "bg-slate-800 text-white shadow-lg scale-110 -translate-y-2";
                const inactiveClasses = "text-slate-400 hover:bg-gray-100";
                
                return `
                <button 
                  onclick="switchDay(${idx})"
                  class="flex flex-col items-center justify-center w-12 h-12 rounded-xl transition-all duration-200 ${isActive ? activeClasses : inactiveClasses}"
                >
                  <span class="text-xs font-bold font-mono">D${d.day}</span>
                  ${isActive ? '<div class="w-1 h-1 bg-white rounded-full mt-1"></div>' : ''}
                </button>`;
            }).join('');
        }

        window.switchDay = function(index) {
            currentDayIndex = index;
            renderApp();
        }

        document.addEventListener('DOMContentLoaded', () => {
            renderApp();
        });

    </script>
</body>
</html>